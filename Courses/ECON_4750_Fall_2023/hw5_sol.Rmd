---
title: "Homework 4 Solutions"
output: 
  html_document:
    theme: united
    css: "style.css"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{var}}
\renewcommand{\P}{\mathrm{P}}
\newcommand{\Cov}{\mathrm{cov}}
\newcommand{\Corr}{\mathrm{corr}}

# Ch. 5, Coding Question 3

```{r}
load("../../Detailed Course Notes/data/fertilizer_2000.RData")
library(modelsummary)

# regression for part a
reg_a <- lm(log(avyield) ~ log(avfert), data=fertilizer_2000)

# regression for part b
reg_b <- lm(log(avyield) ~ log(avfert) + prec, data=fertilizer_2000)

# regression for part c
reg_c <- lm(log(avyield) ~ log(avfert)*as.factor(region_wb) + prec, data=fertilizer_2000)

# print results for all parts
modelsummary(list(reg_a, reg_b, reg_c))
```

a) We estimate that a 1% increase in fertilizer usage increases crop yield by .256% on average (this is strongly statistically significant from 0).  

b) When we additionally control for precipitation, we estimate that a 1% increase in fertilizer usage increases crop yield by .237% on average holding precipitation constant (this is strongly statistically significant from 0).

c) In the last specification, we include control variables for a country's region as well as interaction terms between region and `log(fertilizer)`.  Since none of these interaction terms are statistically different from 0, we do not have strong evidence that effects of fertilizer are different across regions.  Importantly, this does not necessarily mean that these effects are all the same; some of the differences appear large in magnitude, but we only have 68 observations total here, so it might just be the case that we do not have enough data to reliably detect differences across regions.

# Ch. 5, Coding Question 4

```{r}
# load the data
load("../../Detailed Course Notes/data/mutual_funds.RData")
```

a) median `fund_net_annual_expense_ratio`
    
    ```{r}
    median(mutual_funds$fund_net_annual_expense_ratio)
    ```

b) 
    
    ```{r}
    med_er <- median(mutual_funds$fund_net_annual_expense_ratio)
    mutual_funds$high_expense_ratio <- 1*(mutual_funds$fund_net_annual_expense_ratio > med_er)
    ```
    
    ```{r message=FALSE}
    library(modelsummary)
    library(dplyr)
    datasummary_balance(~high_expense_ratio,
                        data=select(mutual_funds,
                                    high_expense_ratio,
                                    fund_return_3years,
                                    fund_net_annual_expense_ratio,
                                    risk_rating,
                                    asset_cash,
                                    asset_stocks,
                                    asset_bonds))
    ```
    
    Yes, there are interesting patterns here.  Mutual funds with high expense ratios appear to have lower returns, about the same amount of risk, and invest more in bonds particularly relative to stocks.

c)

    ```{r}
    reg_c <- lm(fund_return_3years ~ fund_net_annual_expense_ratio, data=mutual_funds)
    summary(reg_c)
    ```
    
    This indicates that for every one unit increase in the expense ratio (which, importantly, is a big increase), on average the 3 year return of a mutual fund decreases by 0.4, and the effect is statistically significant.  The average 3 year return in our data is 4.56, so a decrease in the return of 0.4 seems like a medium-sized decrease to me.

d)
    
    ```{r}
    reg_d <- lm(fund_return_3years ~ fund_net_annual_expense_ratio + as.factor(investment_type) + 
                  risk_rating + as.factor(size_type), data=mutual_funds)
    summary(reg_d)
    ```
    
    We estimate that, on average, when the expense ratio increases by 1, the three year return of mutual funds decreases by 0.63 holding investment type, risk rating, and size of the mutual fund constant.  Thus, if anything, controlling for investment type, risk rating, and the size of the mutual fund seems to make the average effect of expense ratio on the 3 year return even more negative relative to the case when we did not control for them.
    
e)
    
    ```{r}
    reg_e <- lm(fund_return_3years ~ fund_net_annual_expense_ratio + as.factor(investment_type) + 
                  risk_rating + as.factor(size_type) + asset_cash + asset_stocks + asset_bonds,
                data=mutual_funds)
    summary(reg_e)
    ```
    
    These results are very similar to the previous two sets of results.  We estimate that, on average, when the expense ratio increases by 1, the three year return of mutual funds decreases by -0.53 holding investment type, risk rating, size of the mutual fund, and percentage of assets in cash, stocks, and bonds constant.
    
    From the summary statistics, we saw that mutual funds with higher expense ratios tended to have lower returns than mutual funds with lower expense ratios.  If we interpret higher expense ratios as being a proxy for active management of the mutual fund, it suggests that actively managed funds tend to have lower returns.  One possible explanation for this would be that passive mutual funds might tend to make different types of investment (and, e.g., it seems possible that passive stock index funds might involve higher risk).  However, even when we controlled for a number of variables that are likely related to how risky the investments for a particular index fund were, we still estimated that mutual funds with higher expense ratios still tended to have lower returns.
    
# Ch.5, Extra Question 1

$\beta_1$ is how much earnings increase on average when years of education increases by 1 year.

# Ch.5, Extra Question 2

$\beta_1$ is how much earnings increase on average when years of education increases by 1 holding experience and gender constant.

# Ch.5, Extra Question 3

a) You can run the following regression

    $$Earnings = \beta_0 + \beta_1 Education + \beta_2 Female + \beta_3 Education \times Female + U$$

    and test whether $\beta_3=0$ (if it is different from 0, that would indicate that the return to education for women relative to men)

b) You can estimate the following regression

    $$Earnings = \beta_0 + \beta_1 Education + \beta_2 Female + \beta_3 Education \times Female + \beta_4 Experience + U$$

    and continue to test whether $\beta_3=0$.

# Ch.5, Extra Question 4

$100 \beta_1$ is the average percentage change in earnings when education increases by 1 holding experience and sex constant.

# Ch.6, Extra Question 1

$R^2$ is a measure of the in-sample fit of a regression.  If we are interested in choosing a model that will predict well out-of-simple, ranking different models by in-sample fit may not be appropriate.  Second, $R^2$ will always be larger for more complicated models relative to simpler models.  This can lead to overfitting and poor out-of-sample predictions.

# Ch.6, Extra Question 2

For AIC and BIC, the "penalty"/"cost" terms tend to increase these quantities while the "benefit" of adding a regressor comes from decreasing $SSR$ (and, hence, decreasing the value of AIC and/or BIC).  This means that models that do well according to these criteria will have low values of AIC/BIC and models that do poorly will have high values of AIC/BIC; therefore, we choose the model that minimizes AIC/BIC.